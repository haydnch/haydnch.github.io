<!DOCTYPE html>
<html lang="zh-CN">

  <head>
  
<script src="/js/clicklove.js"></script>

  
  <meta charset="utf-8">
  <meta http-equiv="Page-Enter" content="RevealTrans(duration=5,Transitionv=4)">
  <meta name="baidu-site-verification" content="ejqj9vGHRM" />
  <meta name="haydn" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  
  <title>Springä¸­ç»å…¸çš„9ç§è®¾è®¡æ¨¡å¼ | Haydn&#39;s Blog</title>
  
  
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>	 
  
  
   <!-- jquery3.3.1 -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

  
  
<script src="/js/yinghua.js"></script>


  
    <link rel="apple-touch-icon" href="/images/favicon.jpg">
    <link rel="icon" href="/images/favicon.jpg">
  
  
  
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">
  
  <!-- å¼•å…¥font-awesomeå­—ä½“ -->
  <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <!-- hexo site css -->
  
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/github-markdown.css">
<link rel="stylesheet" href="/css/highlight.css">


 
  <!-- fancybox -->
  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <script async src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  
<script src="/js/fancybox.js"></script>


  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-176391873-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-176391873-1');
    </script>
  

<meta name="generator" content="Hexo 5.1.1"></head>


  <body>
    <div id="app">
      <div class="header">

  <div class = "music" >
  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=350 height=86 
	src="//music.163.com/outchain/player?type=2&id=316938&auto=0&height=66">
  </iframe>
  </div>
  <div class="avatar">
    <a href="">
       <!-- å¤´åƒå–æ¶ˆæ‡’åŠ è½½ï¼Œæ·»åŠ no-lazy -->
      
        <img src="/images/bear.jpg" alt="">
      
    </a>
    <div class="nickname">ï¸ğŸ¬Haydn CH</div>	
  </div>
  <div class="poem">
   <span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯...</span> 
    <!--
	<div id="poem_sentence"></div>
	<div id="poem_info"></div>
	-->
  </div>
  <div id="he-plugin-simple"></div>
<script>
WIDGET = {
  CONFIG: {
    "modules": "01234",
    "background": 5,
    "tmpColor": "4A4A4A",
    "tmpSize": 16,
    "cityColor": "4A4A4A",
    "citySize": 16,
    "aqiSize": 16,
    "weatherIconSize": 24,
    "alertIconSize": 18,
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "fixed": "true",
    "vertical": "middle",
    "horizontal": "center",
    "right": 10,
    "top": "5",
    "key": "1fd384bb1a5d4bb7922b269608451085"
  }
}
</script>
<script src="https://widget.heweather.net/simple/static/js/he-simple-common.js?v=1.1"></script>

  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">ä¸»é¡µ</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">å½’æ¡£</a>
        </li>
      
        <li class="nav-item" data-path="/categories/">
          <a href="/categories/">åˆ†ç±»</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">æ ‡ç­¾</a>
        </li>
      
        <li class="nav-item" data-path="/friends/">
          <a href="/friends/">å‹é“¾</a>
        </li>
      
    </ul>
	
  </div>
 


</div>


<script src="/js/activeNav.js"></script>


	
      <div class="flex-container">
        <!-- æ–‡ç« è¯¦æƒ…é¡µï¼Œå±•ç¤ºæ–‡ç« å…·ä½“å†…å®¹ï¼Œurlå½¢å¼ï¼šhttps://yoursite/æ–‡ç« æ ‡é¢˜/ -->
<!-- åŒæ—¶ä¸ºã€Œæ ‡ç­¾tagã€ï¼Œã€Œæœ‹å‹friendã€ï¼Œã€Œåˆ†ç±»categoriesã€ï¼Œã€Œå…³äºaboutã€é¡µé¢çš„æ‰¿è½½é¡µé¢ï¼Œå…·ä½“å±•ç¤ºå–å†³äºpage.type -->










    <!-- æ–‡ç« å†…å®¹é¡µ urlå½¢å¼ï¼šhttps://yoursite/æ–‡ç« æ ‡é¢˜/ -->
    <div class="container post-details" id="post-details">
        <div class="post-content">
            <div class="post-title">Springä¸­ç»å…¸çš„9ç§è®¾è®¡æ¨¡å¼</div>
            <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime" title="åˆ›å»ºæ—¥æœŸ | post_time"></i>
          2021-03-15 14:02
        </span>
		<span class="post-pubtime">
          <i class="iconfont icon-edit" title="æ–‡ç« å­—æ•° | word_count"></i>
             <span class="post-count">3.4k</span>å­—
        </span>

                
                    <span class="post-categories">
                <i class="iconfont icon-bookmark" title="ç±»åˆ« | categories"></i>
                        
                            <span class="span--category">
                  <a href="/categories/design-patterns/" title="æŸ¥çœ‹ è®¾è®¡æ¨¡å¼ åˆ†ç±»">
                    <b>#</b> è®¾è®¡æ¨¡å¼
                  </a>
                </span>
                        
                    </span>
                
                    <span class="post-tags">
                <i class="iconfont icon-tags" title="æ ‡ç­¾ | tags"></i>
                        
                            <span class="span--tag">
                  <a href="/tags/Spring/" title="æŸ¥çœ‹ Spring æ ‡ç­¾">
                    <b>#</b> Spring
                  </a>
                </span>
                        
                    </span>
                
                
                    <!-- ä¸è’œå­ç»Ÿè®¡ -->
                    <span id="busuanzi_container_page_pv" class="post-readNum">
              <i class="iconfont icon-eye"></i>
			    é˜…è¯»é‡ï¼š<span id="busuanzi_value_page_pv">
			  <i class="fa fa-spinner fa-spin"></i></span>
        </span>
                
            </div>
	         
                <div class="prev-or-next">
                    <div class="post-foot-prev">
                        
                    </div>
             
                    <div class="post-foot-prev">
                        
                            <a href="/f943ea312617/" target="_self">
                                <span>NEXT: Mavenæ‰“åŒ…çš„å‚æ•°å­¦ä¹ </span>
                                <i class="iconfont icon-chevronright"></i>
                            </a>
                        
                    </div>
                </div>
            
			
            <div class="markdown-body">
                <p><strong>1.ç®€å•å·¥å‚(é23ç§è®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§)</strong></p>
<p><strong>2.å·¥å‚æ–¹æ³•</strong></p>
<p><strong>3.å•ä¾‹æ¨¡å¼</strong></p>
<p><strong>4.é€‚é…å™¨æ¨¡å¼</strong></p>
<p><strong>5.è£…é¥°å™¨æ¨¡å¼</strong></p>
<p><strong>6.ä»£ç†æ¨¡å¼</strong></p>
<p><strong>7.è§‚å¯Ÿè€…æ¨¡å¼</strong></p>
<p><strong>8.ç­–ç•¥æ¨¡å¼</strong></p>
<p><strong>9.æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</strong></p>
<h2 id="1-ç®€å•å·¥å‚-é23ç§è®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§"><a href="#1-ç®€å•å·¥å‚-é23ç§è®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§" class="headerlink" title="1. ç®€å•å·¥å‚(é23ç§è®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§)"></a>1. ç®€å•å·¥å‚(é23ç§è®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§)</h2><p><strong>å®ç°æ–¹å¼</strong>ï¼š</p>
<p>BeanFactoryã€‚Springä¸­çš„BeanFactoryå°±æ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„ä½“ç°ï¼Œæ ¹æ®ä¼ å…¥ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†æ¥è·å¾—Beanå¯¹è±¡ï¼Œä½†æ˜¯å¦æ˜¯åœ¨ä¼ å…¥å‚æ•°ååˆ›å»ºè¿˜æ˜¯ä¼ å…¥å‚æ•°å‰åˆ›å»ºè¿™ä¸ªè¦æ ¹æ®å…·ä½“æƒ…å†µæ¥å®šã€‚</p>
<p><strong>å®è´¨ï¼š</strong></p>
<p>ç”±ä¸€ä¸ªå·¥å‚ç±»æ ¹æ®ä¼ å…¥çš„å‚æ•°ï¼ŒåŠ¨æ€å†³å®šåº”è¯¥åˆ›å»ºå“ªä¸€ä¸ªäº§å“ç±»ã€‚</p>
<p><strong>å®ç°åŸç†ï¼š</strong></p>
<p><strong>beanå®¹å™¨çš„å¯åŠ¨é˜¶æ®µï¼š</strong></p>
<ul>
<li><p>è¯»å–beançš„xmlé…ç½®æ–‡ä»¶,å°†beanå…ƒç´ åˆ†åˆ«è½¬æ¢æˆä¸€ä¸ªBeanDefinitionå¯¹è±¡ã€‚</p>
</li>
<li><p>ç„¶åé€šè¿‡BeanDefinitionRegistryå°†è¿™äº›beanæ³¨å†Œåˆ°beanFactoryä¸­ï¼Œä¿å­˜åœ¨å®ƒçš„ä¸€ä¸ªConcurrentHashMapä¸­ã€‚</p>
</li>
<li><p>å°†BeanDefinitionæ³¨å†Œåˆ°äº†beanFactoryä¹‹åï¼Œåœ¨è¿™é‡ŒSpringä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ‰©å±•çš„åˆ‡å£ï¼Œå…è®¸æˆ‘ä»¬é€šè¿‡å®ç°æ¥å£BeanFactoryPostProcessor åœ¨æ­¤å¤„æ¥æ’å…¥æˆ‘ä»¬å®šä¹‰çš„ä»£ç ã€‚</p>
<p>å…¸å‹çš„ä¾‹å­å°±æ˜¯ï¼šPropertyPlaceholderConfigurerï¼Œæˆ‘ä»¬ä¸€èˆ¬åœ¨é…ç½®æ•°æ®åº“çš„dataSourceæ—¶ä½¿ç”¨åˆ°çš„å ä½ç¬¦çš„å€¼ï¼Œå°±æ˜¯å®ƒæ³¨å…¥è¿›å»çš„ã€‚</p>
</li>
</ul>
<p><strong>å®¹å™¨ä¸­beançš„å®ä¾‹åŒ–é˜¶æ®µï¼š</strong></p>
<p>å®ä¾‹åŒ–é˜¶æ®µä¸»è¦æ˜¯é€šè¿‡åå°„æˆ–è€…CGLIBå¯¹beanè¿›è¡Œå®ä¾‹åŒ–ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µSpringåˆç»™æˆ‘ä»¬æš´éœ²äº†å¾ˆå¤šçš„æ‰©å±•ç‚¹ï¼š</p>
<ul>
<li><strong>å„ç§çš„Awareæ¥å£</strong> ï¼Œæ¯”å¦‚ BeanFactoryAwareï¼Œå¯¹äºå®ç°äº†è¿™äº›Awareæ¥å£çš„beanï¼Œåœ¨å®ä¾‹åŒ–beanæ—¶Springä¼šå¸®æˆ‘ä»¬æ³¨å…¥å¯¹åº”çš„BeanFactoryçš„å®ä¾‹ã€‚</li>
<li><strong>BeanPostProcessoræ¥å£</strong> ï¼Œå®ç°äº†BeanPostProcessoræ¥å£çš„beanï¼Œåœ¨å®ä¾‹åŒ–beanæ—¶Springä¼šå¸®æˆ‘ä»¬è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•ã€‚</li>
<li><strong>InitializingBeanæ¥å£</strong> ï¼Œå®ç°äº†InitializingBeanæ¥å£çš„beanï¼Œåœ¨å®ä¾‹åŒ–beanæ—¶Springä¼šå¸®æˆ‘ä»¬è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•ã€‚</li>
<li><strong>DisposableBeanæ¥å£</strong> ï¼Œå®ç°äº†BeanPostProcessoræ¥å£çš„beanï¼Œåœ¨è¯¥beanæ­»äº¡æ—¶Springä¼šå¸®æˆ‘ä»¬è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•ã€‚</li>
</ul>
<h3 id="è®¾è®¡æ„ä¹‰ï¼š"><a href="#è®¾è®¡æ„ä¹‰ï¼š" class="headerlink" title="è®¾è®¡æ„ä¹‰ï¼š"></a>è®¾è®¡æ„ä¹‰ï¼š</h3><p><strong>æ¾è€¦åˆã€‚</strong> å¯ä»¥å°†åŸæ¥ç¡¬ç¼–ç çš„ä¾èµ–ï¼Œé€šè¿‡Springè¿™ä¸ªbeanFactoryè¿™ä¸ªå·¥å‚æ¥æ³¨å…¥ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯è¯´åŸæ¥åªæœ‰ä¾èµ–æ–¹å’Œè¢«ä¾èµ–æ–¹ï¼Œç°åœ¨æˆ‘ä»¬å¼•å…¥äº†ç¬¬ä¸‰æ–¹â€”â€”springè¿™ä¸ªbeanFactoryï¼Œç”±å®ƒæ¥è§£å†³beanä¹‹é—´çš„ä¾èµ–é—®é¢˜ï¼Œè¾¾åˆ°äº†æ¾è€¦åˆçš„æ•ˆæœ.</p>
<p><strong>beançš„é¢å¤–å¤„ç†ã€‚</strong> é€šè¿‡Springæ¥å£çš„æš´éœ²ï¼Œåœ¨å®ä¾‹åŒ–beançš„é˜¶æ®µæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€äº›é¢å¤–çš„å¤„ç†ï¼Œè¿™äº›é¢å¤–çš„å¤„ç†åªéœ€è¦è®©beanå®ç°å¯¹åº”çš„æ¥å£å³å¯ï¼Œé‚£ä¹ˆspringå°±ä¼šåœ¨beançš„ç”Ÿå‘½å‘¨æœŸè°ƒç”¨æˆ‘ä»¬å®ç°çš„æ¥å£æ¥å¤„ç†è¯¥beanã€‚<code>[éå¸¸é‡è¦]</code></p>
<h2 id="2-å·¥å‚æ–¹æ³•"><a href="#2-å·¥å‚æ–¹æ³•" class="headerlink" title="2.å·¥å‚æ–¹æ³•"></a>2.å·¥å‚æ–¹æ³•</h2><p><strong>å®ç°æ–¹å¼ï¼š</strong>FactoryBeanæ¥å£ã€‚</p>
<p><strong>å®ç°åŸç†ï¼š</strong>å®ç°äº†FactoryBeanæ¥å£çš„beanæ˜¯ä¸€ç±»å«åšfactoryçš„beanã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼Œspringä¼šåœ¨ä½¿ç”¨getBean()è°ƒç”¨è·å¾—è¯¥beanæ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥beançš„getObject()æ–¹æ³•ï¼Œæ‰€ä»¥è¿”å›çš„ä¸æ˜¯factoryè¿™ä¸ªbeanï¼Œè€Œæ˜¯è¿™ä¸ªbean.getOjbect()æ–¹æ³•çš„è¿”å›å€¼ã€‚</p>
<p><strong>ä¾‹å­ï¼š</strong>å…¸å‹çš„ä¾‹å­æœ‰springä¸mybatisçš„ç»“åˆã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/6mychickmupUtF7H8k5iadhWHuBhBfDu5nsNJ2yN4qDgcbaVXIhQnaSOHGePa30P6NibkLIvOHN9nic6iawZDuWTvjA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<p><strong>è¯´æ˜ï¼š</strong></p>
<p>æˆ‘ä»¬çœ‹ä¸Šé¢è¯¥beanï¼Œå› ä¸ºå®ç°äº†FactoryBeanæ¥å£ï¼Œæ‰€ä»¥è¿”å›çš„ä¸æ˜¯ SqlSessionFactoryBean çš„å®ä¾‹ï¼Œè€Œæ˜¯å®ƒçš„ SqlSessionFactoryBean.getObject() çš„è¿”å›å€¼ã€‚</p>
<h2 id="3-å•ä¾‹æ¨¡å¼"><a href="#3-å•ä¾‹æ¨¡å¼" class="headerlink" title="3.å•ä¾‹æ¨¡å¼"></a>3.å•ä¾‹æ¨¡å¼</h2><p>Springä¾èµ–æ³¨å…¥Beanå®ä¾‹é»˜è®¤æ˜¯å•ä¾‹çš„ã€‚</p>
<p>Springçš„ä¾èµ–æ³¨å…¥ï¼ˆåŒ…æ‹¬lazy-initæ–¹å¼ï¼‰éƒ½æ˜¯å‘ç”Ÿåœ¨AbstractBeanFactoryçš„getBeané‡Œã€‚getBeançš„doGetBeanæ–¹æ³•è°ƒç”¨getSingletonè¿›è¡Œbeançš„åˆ›å»ºã€‚</p>
<p>åˆ†æ getSingleton() æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">getSingleton</span><span class="params">(String beanName)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å‚æ•°trueè®¾ç½®æ ‡è¯†å…è®¸æ—©æœŸä¾èµ–</span></span><br><span class="line">    <span class="keyword">return</span> getSingleton(beanName,<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> Object <span class="title">getSingleton</span><span class="params">(String beanName, <span class="keyword">boolean</span> allowEarlyReference)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨å®ä¾‹</span></span><br><span class="line">    Object singletonObject = <span class="keyword">this</span>.singletonObjects.get(beanName);</span><br><span class="line">    <span class="keyword">if</span> (singletonObject == <span class="keyword">null</span> &amp;&amp; isSingletonCurrentlyInCreation(beanName)) &#123;</span><br><span class="line">        <span class="comment">//å¦‚æœä¸ºç©ºï¼Œåˆ™é”å®šå…¨å±€å˜é‡å¹¶è¿›è¡Œå¤„ç†ã€‚</span></span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>.singletonObjects) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœæ­¤beanæ­£åœ¨åŠ è½½ï¼Œåˆ™ä¸å¤„ç†</span></span><br><span class="line">            singletonObject = <span class="keyword">this</span>.earlySingletonObjects.get(beanName);</span><br><span class="line">            <span class="keyword">if</span> (singletonObject == <span class="keyword">null</span> &amp;&amp; allowEarlyReference) &#123;</span><br><span class="line">                <span class="comment">//å½“æŸäº›æ–¹æ³•éœ€è¦æå‰åˆå§‹åŒ–çš„æ—¶å€™åˆ™ä¼šè°ƒç”¨addSingleFactory æ–¹æ³•å°†å¯¹åº”çš„ObjectFactoryåˆå§‹åŒ–ç­–ç•¥å­˜å‚¨åœ¨singletonFactories</span></span><br><span class="line">                ObjectFactory&lt;?&gt; singletonFactory = <span class="keyword">this</span>.singletonFactories.get(beanName);</span><br><span class="line">                <span class="keyword">if</span> (singletonFactory != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="comment">//è°ƒç”¨é¢„å…ˆè®¾å®šçš„getObjectæ–¹æ³•</span></span><br><span class="line">                    singletonObject = singletonFactory.getObject();</span><br><span class="line">                    <span class="comment">//è®°å½•åœ¨ç¼“å­˜ä¸­ï¼ŒearlysingletonObjectså’ŒsingletonFactoriesäº’æ–¥</span></span><br><span class="line">                    <span class="keyword">this</span>.earlySingletonObjects.put(beanName, singletonObject);</span><br><span class="line">                    <span class="keyword">this</span>.singletonFactories.remove(beanName);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (singletonObject != NULL_OBJECT ? singletonObject : <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>getSingleton()è¿‡ç¨‹å›¾</strong></p>
<p>psï¼šspringä¾èµ–æ³¨å…¥æ—¶ï¼Œä½¿ç”¨äº† åŒé‡åˆ¤æ–­åŠ é” çš„å•ä¾‹æ¨¡å¼</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/oTKHc6F8tsjOmmcyPkVvrRjTulVnHSsGIu0l7hMqT4ZVsp5dpeuQwibRDNviaKduG78Tpz16pRUIhdtrx8jPvzWQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<p><strong>å•ä¾‹æ¨¡å¼å®šä¹‰ï¼š</strong> ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚</p>
<p><strong>springå¯¹å•ä¾‹çš„å®ç°ï¼š</strong> springä¸­çš„å•ä¾‹æ¨¡å¼å®Œæˆäº†ååŠå¥è¯ï¼Œå³æä¾›äº†å…¨å±€çš„è®¿é—®ç‚¹BeanFactoryã€‚ä½†æ²¡æœ‰ä»æ„é€ å™¨çº§åˆ«å»æ§åˆ¶å•ä¾‹ï¼Œè¿™æ˜¯å› ä¸ºspringç®¡ç†çš„æ˜¯ä»»æ„çš„javaå¯¹è±¡ã€‚</p>
<h2 id="4-é€‚é…å™¨æ¨¡å¼"><a href="#4-é€‚é…å™¨æ¨¡å¼" class="headerlink" title="4. é€‚é…å™¨æ¨¡å¼"></a>4. é€‚é…å™¨æ¨¡å¼</h2><p><strong>å®ç°æ–¹å¼ï¼š</strong>SpringMVCä¸­çš„é€‚é…å™¨HandlerAdatperã€‚</p>
<p><strong>å®ç°åŸç†ï¼š</strong>HandlerAdatperæ ¹æ®Handlerè§„åˆ™æ‰§è¡Œä¸åŒçš„Handlerã€‚</p>
<p><strong>å®ç°è¿‡ç¨‹ï¼š</strong>DispatcherServletæ ¹æ®HandlerMappingè¿”å›çš„handlerï¼Œå‘HandlerAdatperå‘èµ·è¯·æ±‚ï¼Œå¤„ç†Handlerã€‚</p>
<p>HandlerAdapteræ ¹æ®è§„åˆ™æ‰¾åˆ°å¯¹åº”çš„Handlerå¹¶è®©å…¶æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•åHandlerä¼šå‘HandlerAdapterè¿”å›ä¸€ä¸ªModelAndViewï¼Œæœ€åç”±HandlerAdapterå‘DispatchServeletè¿”å›ä¸€ä¸ªModelAndViewã€‚</p>
<p><strong>å®ç°æ„ä¹‰ï¼š</strong></p>
<p>HandlerAdatperä½¿å¾—Handlerçš„æ‰©å±•å˜å¾—å®¹æ˜“ï¼Œåªéœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„Handlerå’Œä¸€ä¸ªå¯¹åº”çš„HandlerAdapterå³å¯ã€‚</p>
<p>å› æ­¤Springå®šä¹‰äº†ä¸€ä¸ªé€‚é…æ¥å£ï¼Œä½¿å¾—æ¯ä¸€ç§Controlleræœ‰ä¸€ç§å¯¹åº”çš„é€‚é…å™¨å®ç°ç±»ï¼Œè®©é€‚é…å™¨ä»£æ›¿controlleræ‰§è¡Œç›¸åº”çš„æ–¹æ³•ã€‚è¿™æ ·åœ¨æ‰©å±•Controlleræ—¶ï¼Œåªéœ€è¦å¢åŠ ä¸€ä¸ªé€‚é…å™¨ç±»å°±å®Œæˆäº†SpringMVCçš„æ‰©å±•äº†ã€‚</p>
<h2 id="5-è£…é¥°å™¨æ¨¡å¼"><a href="#5-è£…é¥°å™¨æ¨¡å¼" class="headerlink" title="5.è£…é¥°å™¨æ¨¡å¼"></a>5.è£…é¥°å™¨æ¨¡å¼</h2><p><strong>å®ç°æ–¹å¼ï¼š</strong>Springä¸­ç”¨åˆ°çš„åŒ…è£…å™¨æ¨¡å¼åœ¨ç±»åä¸Šæœ‰ä¸¤ç§è¡¨ç°ï¼šä¸€ç§æ˜¯ç±»åä¸­å«æœ‰Wrapperï¼Œå¦ä¸€ç§æ˜¯ç±»åä¸­å«æœ‰Decoratorã€‚</p>
<p><strong>å®è´¨</strong>ï¼šåŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼ŒDecoratoræ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚</p>
<h2 id="6-ä»£ç†æ¨¡å¼"><a href="#6-ä»£ç†æ¨¡å¼" class="headerlink" title="6. ä»£ç†æ¨¡å¼"></a>6. ä»£ç†æ¨¡å¼</h2><p> <strong>å®ç°æ–¹å¼ï¼š</strong>AOPåº•å±‚ï¼Œå°±æ˜¯åŠ¨æ€ä»£ç†æ¨¡å¼çš„å®ç°ã€‚</p>
<p><strong>åŠ¨æ€ä»£ç†ï¼š</strong>åœ¨å†…å­˜ä¸­æ„å»ºçš„ï¼Œä¸éœ€è¦æ‰‹åŠ¨ç¼–å†™ä»£ç†ç±»</p>
<p> <strong>é™æ€ä»£ç†ï¼š</strong>éœ€è¦æ‰‹å·¥ç¼–å†™ä»£ç†ç±»ï¼Œä»£ç†ç±»å¼•ç”¨è¢«ä»£ç†å¯¹è±¡ã€‚</p>
<p> <strong>å®ç°åŸç†ï¼š</strong>åˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æ—¶åˆ»è¢«ç»‡å…¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨ç»‡å…¥åˆ‡é¢æ—¶ï¼ŒAOPå®¹å™¨ä¼šä¸ºç›®æ ‡å¯¹è±¡åˆ›å»ºåŠ¨æ€çš„åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚SpringAOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚</p>
<p>** ç»‡å…¥ï¼š**æŠŠåˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡å¹¶åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚</p>
<h2 id="7-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#7-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="7. è§‚å¯Ÿè€…æ¨¡å¼"></a>7. è§‚å¯Ÿè€…æ¨¡å¼</h2><p><strong>å®ç°æ–¹å¼</strong>ï¼šspringçš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ä½¿ç”¨çš„æ˜¯ è§‚å¯Ÿè€…æ¨¡å¼ ï¼ŒSpringä¸­Observeræ¨¡å¼å¸¸ç”¨çš„åœ°æ–¹æ˜¯listenerçš„å®ç°ã€‚</p>
<p> <strong>å…·ä½“å®ç°ï¼š</strong></p>
<p> <u>äº‹ä»¶æœºåˆ¶çš„å®ç°éœ€è¦ä¸‰ä¸ªéƒ¨åˆ†,äº‹ä»¶æº,äº‹ä»¶,äº‹ä»¶ç›‘å¬å™¨</u></p>
<p>ApplicationEventæŠ½è±¡ç±»[äº‹ä»¶]</p>
<p>ç»§æ‰¿è‡ªjdkçš„EventObject,æ‰€æœ‰çš„äº‹ä»¶éƒ½éœ€è¦ç»§æ‰¿ApplicationEvent,å¹¶ä¸”é€šè¿‡æ„é€ å™¨å‚æ•°sourceå¾—åˆ°äº‹ä»¶æº.</p>
<p>è¯¥ç±»çš„å®ç°ç±»ApplicationContextEventè¡¨ç¤ºApplicaitonContextçš„å®¹å™¨äº‹ä»¶.</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationEvent</span> <span class="keyword">extends</span> <span class="title">EventObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">7099057708183571937L</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> timestamp;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ApplicationEvent</span><span class="params">(Object source)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(source);</span><br><span class="line">    <span class="keyword">this</span>.timestamp = System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> <span class="title">getTimestamp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.timestamp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ApplicationListeneræ¥å£<code>[äº‹ä»¶ç›‘å¬å™¨]</code></p>
<p>ç»§æ‰¿è‡ªjdkçš„EventListener,æ‰€æœ‰çš„ç›‘å¬å™¨éƒ½è¦å®ç°è¿™ä¸ªæ¥å£ã€‚</p>
<p>è¿™ä¸ªæ¥å£åªæœ‰ä¸€ä¸ªonApplicationEvent()æ–¹æ³•,è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªApplicationEventæˆ–å…¶å­ç±»å¯¹è±¡ä½œä¸ºå‚æ•°,åœ¨æ–¹æ³•ä½“ä¸­,å¯ä»¥é€šè¿‡ä¸åŒå¯¹Eventç±»çš„åˆ¤æ–­æ¥è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p>
<p>å½“äº‹ä»¶è§¦å‘æ—¶æ‰€æœ‰çš„ç›‘å¬å™¨éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApplicationListener</span>&lt;<span class="title">E</span> <span class="keyword">extends</span> <span class="title">ApplicationEvent</span>&gt; <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">void</span> <span class="title">onApplicationEvent</span><span class="params">(E event)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ApplicationContextæ¥å£<code>[äº‹ä»¶æº]</code></p>
<p>ApplicationContextæ˜¯springä¸­çš„å…¨å±€å®¹å™¨ï¼Œç¿»è¯‘è¿‡æ¥æ˜¯â€åº”ç”¨ä¸Šä¸‹æ–‡â€ã€‚</p>
<p>å®ç°äº†ApplicationEventPublisheræ¥å£ã€‚</p>
<p> <strong>èŒè´£</strong>ï¼š</p>
<p>è´Ÿè´£è¯»å–beançš„é…ç½®æ–‡æ¡£,ç®¡ç†beançš„åŠ è½½,ç»´æŠ¤beanä¹‹é—´çš„ä¾èµ–å…³ç³»,å¯ä»¥è¯´æ˜¯è´Ÿè´£beançš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ,å†é€šä¿—ä¸€ç‚¹å°±æ˜¯æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„IOCå®¹å™¨ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApplicationEventPublisher</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">publishEvent</span><span class="params">(ApplicationEvent event)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">publishEvent</span><span class="params">(ApplicationEvent event)</span> </span>&#123;</span><br><span class="line">    Assert.notNull(event, <span class="string">&quot;Event must not be null&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class="line">         logger.trace(<span class="string">&quot;Publishing event in &quot;</span> + getDisplayName() + <span class="string">&quot;: &quot;</span> + event);</span><br><span class="line">    &#125;</span><br><span class="line">    getApplicationEventMulticaster().multicastEvent(event);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.parent != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.parent.publishEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ApplicationEventMulticasteræŠ½è±¡ç±»<code>[äº‹ä»¶æºä¸­publishEventæ–¹æ³•éœ€è¦è°ƒç”¨å…¶æ–¹æ³•getApplicationEventMulticaster]</code></p>
<p>å±äºäº‹ä»¶å¹¿æ’­å™¨,å®ƒçš„ä½œç”¨æ˜¯æŠŠApplicationcontextå‘å¸ƒçš„Eventå¹¿æ’­ç»™æ‰€æœ‰çš„ç›‘å¬å™¨.</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractApplicationContext</span> <span class="keyword">extends</span> <span class="title">DefaultResourceLoader</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">ConfigurableApplicationContext</span>, <span class="title">DisposableBean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ApplicationEventMulticaster applicationEventMulticaster;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">registerListeners</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Register statically specified listeners first.</span></span><br><span class="line">    <span class="keyword">for</span> (ApplicationListener&lt;?&gt; listener : getApplicationListeners()) &#123;</span><br><span class="line">    getApplicationEventMulticaster().addApplicationListener(listener);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Do not initialize FactoryBeans here: We need to leave all regular beans</span></span><br><span class="line">    <span class="comment">// uninitialized to let post-processors apply to them!</span></span><br><span class="line">    String[] listenerBeanNames = getBeanNamesForType(ApplicationListener.class, <span class="keyword">true</span>, <span class="keyword">false</span>);</span><br><span class="line">    <span class="keyword">for</span> (String lisName : listenerBeanNames) &#123;</span><br><span class="line">    getApplicationEventMulticaster().addApplicationListenerBean(lisName);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-ç­–ç•¥æ¨¡å¼"><a href="#8-ç­–ç•¥æ¨¡å¼" class="headerlink" title="8.ç­–ç•¥æ¨¡å¼"></a>8.ç­–ç•¥æ¨¡å¼</h2><p> <strong>å®ç°æ–¹å¼ï¼š</strong></p>
<p>Springæ¡†æ¶çš„èµ„æºè®¿é—®Resourceæ¥å£ã€‚è¯¥æ¥å£æä¾›äº†æ›´å¼ºçš„èµ„æºè®¿é—®èƒ½åŠ›ï¼ŒSpring æ¡†æ¶æœ¬èº«å¤§é‡ä½¿ç”¨äº† Resource æ¥å£æ¥è®¿é—®åº•å±‚èµ„æºã€‚</p>
<p> <strong>Resource æ¥å£ä»‹ç»</strong></p>
<p>source æ¥å£æ˜¯å…·ä½“èµ„æºè®¿é—®ç­–ç•¥çš„æŠ½è±¡ï¼Œä¹Ÿæ˜¯æ‰€æœ‰èµ„æºè®¿é—®ç±»æ‰€å®ç°çš„æ¥å£ã€‚</p>
<p>Resource æ¥å£ä¸»è¦æä¾›äº†å¦‚ä¸‹å‡ ä¸ªæ–¹æ³•:</p>
<ul>
<li><strong>getInputStream()ï¼š</strong> å®šä½å¹¶æ‰“å¼€èµ„æºï¼Œè¿”å›èµ„æºå¯¹åº”çš„è¾“å…¥æµã€‚æ¯æ¬¡è°ƒç”¨éƒ½è¿”å›æ–°çš„è¾“å…¥æµã€‚è°ƒç”¨è€…å¿…é¡»è´Ÿè´£å…³é—­è¾“å…¥æµã€‚</li>
<li><strong>exists()ï¼š</strong> è¿”å› Resource æ‰€æŒ‡å‘çš„èµ„æºæ˜¯å¦å­˜åœ¨ã€‚</li>
<li><strong>isOpen()ï¼š</strong> è¿”å›èµ„æºæ–‡ä»¶æ˜¯å¦æ‰“å¼€ï¼Œå¦‚æœèµ„æºæ–‡ä»¶ä¸èƒ½å¤šæ¬¡è¯»å–ï¼Œæ¯æ¬¡è¯»å–ç»“æŸåº”è¯¥æ˜¾å¼å…³é—­ï¼Œä»¥é˜²æ­¢èµ„æºæ³„æ¼ã€‚</li>
<li><strong>getDescription()ï¼š</strong> è¿”å›èµ„æºçš„æè¿°ä¿¡æ¯ï¼Œé€šå¸¸ç”¨äºèµ„æºå¤„ç†å‡ºé”™æ—¶è¾“å‡ºè¯¥ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯å…¨é™å®šæ–‡ä»¶åæˆ–å®é™… URLã€‚</li>
<li><strong>getFileï¼š</strong> è¿”å›èµ„æºå¯¹åº”çš„ File å¯¹è±¡ã€‚</li>
<li><strong>getURLï¼š</strong> è¿”å›èµ„æºå¯¹åº”çš„ URL å¯¹è±¡ã€‚</li>
</ul>
<p>æœ€åä¸¤ä¸ªæ–¹æ³•é€šå¸¸æ— é¡»ä½¿ç”¨ï¼Œä»…åœ¨é€šè¿‡ç®€å•æ–¹å¼è®¿é—®æ— æ³•å®ç°æ—¶ï¼ŒResource æä¾›ä¼ ç»Ÿçš„èµ„æºè®¿é—®çš„åŠŸèƒ½ã€‚</p>
<p>Resource æ¥å£æœ¬èº«æ²¡æœ‰æä¾›è®¿é—®ä»»ä½•åº•å±‚èµ„æºçš„å®ç°é€»è¾‘ï¼Œ<strong>é’ˆå¯¹ä¸åŒçš„åº•å±‚èµ„æºï¼ŒSpring å°†ä¼šæä¾›ä¸åŒçš„ Resource å®ç°ç±»ï¼Œä¸åŒçš„å®ç°ç±»è´Ÿè´£ä¸åŒçš„èµ„æºè®¿é—®é€»è¾‘ã€‚</strong></p>
<p>Spring ä¸º Resource æ¥å£æä¾›äº†å¦‚ä¸‹å®ç°ç±»ï¼š</p>
<ul>
<li><strong>UrlResourceï¼š</strong> è®¿é—®ç½‘ç»œèµ„æºçš„å®ç°ç±»ã€‚</li>
<li><strong>ClassPathResourceï¼š</strong> è®¿é—®ç±»åŠ è½½è·¯å¾„é‡Œèµ„æºçš„å®ç°ç±»ã€‚</li>
<li><strong>FileSystemResourceï¼š</strong> è®¿é—®æ–‡ä»¶ç³»ç»Ÿé‡Œèµ„æºçš„å®ç°ç±»ã€‚</li>
<li><strong>ServletContextResourceï¼š</strong> è®¿é—®ç›¸å¯¹äº ServletContext è·¯å¾„é‡Œçš„èµ„æºçš„å®ç°ç±».</li>
<li><strong>InputStreamResourceï¼š</strong> è®¿é—®è¾“å…¥æµèµ„æºçš„å®ç°ç±»ã€‚</li>
<li><strong>ByteArrayResourceï¼š</strong> è®¿é—®å­—èŠ‚æ•°ç»„èµ„æºçš„å®ç°ç±»ã€‚</li>
</ul>
<p>è¿™äº› Resource å®ç°ç±»ï¼Œé’ˆå¯¹ä¸åŒçš„çš„åº•å±‚èµ„æºï¼Œæä¾›äº†ç›¸åº”çš„èµ„æºè®¿é—®é€»è¾‘ï¼Œå¹¶æä¾›ä¾¿æ·çš„åŒ…è£…ï¼Œä»¥åˆ©äºå®¢æˆ·ç«¯ç¨‹åºçš„èµ„æºè®¿é—®ã€‚</p>
<h2 id="9-æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼"><a href="#9-æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼" class="headerlink" title="9.æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼"></a>9.æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</h2><p> <strong>ç»å…¸æ¨¡æ¿æ–¹æ³•å®šä¹‰</strong>ï¼š</p>
<p>çˆ¶ç±»å®šä¹‰äº†éª¨æ¶ï¼ˆè°ƒç”¨å“ªäº›æ–¹æ³•åŠé¡ºåºï¼‰ï¼ŒæŸäº›ç‰¹å®šæ–¹æ³•ç”±å­ç±»å®ç°ã€‚</p>
<p>æœ€å¤§çš„å¥½å¤„ï¼šä»£ç å¤ç”¨ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚é™¤äº†å­ç±»è¦å®ç°çš„ç‰¹å®šæ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•åŠæ–¹æ³•è°ƒç”¨é¡ºåºéƒ½åœ¨çˆ¶ç±»ä¸­é¢„å…ˆå†™å¥½äº†ã€‚</p>
<p><strong>æ‰€ä»¥çˆ¶ç±»æ¨¡æ¿æ–¹æ³•ä¸­æœ‰ä¸¤ç±»æ–¹æ³•ï¼š</strong></p>
<p><strong>å…±åŒçš„æ–¹æ³•ï¼š</strong> æ‰€æœ‰å­ç±»éƒ½ä¼šç”¨åˆ°çš„ä»£ç </p>
<p><strong>ä¸åŒçš„æ–¹æ³•ï¼š</strong> å­ç±»è¦è¦†ç›–çš„æ–¹æ³•ï¼Œåˆ†ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li>æŠ½è±¡æ–¹æ³•ï¼šçˆ¶ç±»ä¸­çš„æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»è¦†ç›–</li>
<li>é’©å­æ–¹æ³•ï¼šçˆ¶ç±»ä¸­æ˜¯ä¸€ä¸ªç©ºæ–¹æ³•ï¼Œå­ç±»ç»§æ‰¿äº†é»˜è®¤ä¹Ÿæ˜¯ç©ºçš„</li>
</ul>
<p>æ³¨ï¼šä¸ºä»€ä¹ˆå«é’©å­ï¼Œå­ç±»å¯ä»¥é€šè¿‡è¿™ä¸ªé’©å­ï¼ˆæ–¹æ³•ï¼‰ï¼Œæ§åˆ¶çˆ¶ç±»ï¼Œå› ä¸ºè¿™ä¸ªé’©å­å®é™…æ˜¯çˆ¶ç±»çš„æ–¹æ³•ï¼ˆç©ºæ–¹æ³•ï¼‰ï¼</p>
<p><strong>Spring æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®è´¨</strong>ï¼š</p>
<p>æ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼å’Œå›è°ƒæ¨¡å¼çš„ç»“åˆï¼Œæ˜¯Template Methodä¸éœ€è¦ç»§æ‰¿çš„å¦ä¸€ç§å®ç°æ–¹å¼ã€‚Springå‡ ä¹æ‰€æœ‰çš„å¤–æ¥æ‰©å±•éƒ½é‡‡ç”¨è¿™ç§æ¨¡å¼ã€‚</p>
<p> <strong>å…·ä½“å®ç°</strong>ï¼š</p>
<p>JDBCçš„æŠ½è±¡å’Œå¯¹Hibernateçš„é›†æˆï¼Œéƒ½é‡‡ç”¨äº†ä¸€ç§ç†å¿µæˆ–è€…å¤„ç†æ–¹å¼ï¼Œé‚£å°±æ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸ç›¸åº”çš„Callbackæ¥å£ç›¸ç»“åˆã€‚</p>
<p>é‡‡ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸ºäº†ä»¥ä¸€ç§ç»Ÿä¸€è€Œé›†ä¸­çš„æ–¹å¼æ¥å¤„ç†èµ„æºçš„è·å–å’Œé‡Šæ”¾ï¼Œä»¥JdbcTempalteä¸ºä¾‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcTemplate</span> </span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">final</span> Object executeï¼ˆString sqlï¼‰&#123;</span><br><span class="line">        Connection con=<span class="keyword">null</span>;</span><br><span class="line">        Statement stmt=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con=getConnectionï¼ˆï¼‰;</span><br><span class="line">            stmt=con.createStatementï¼ˆï¼‰;</span><br><span class="line">            Object retValue=executeWithStatementï¼ˆstmt,sqlï¼‰;</span><br><span class="line">            <span class="keyword">return</span> retValue;</span><br><span class="line">        &#125;<span class="keyword">catch</span>ï¼ˆSQLException eï¼‰&#123;</span><br><span class="line">             ...</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            closeStatementï¼ˆstmtï¼‰;</span><br><span class="line">            releaseConnectionï¼ˆconï¼‰;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> Object executeWithStatementï¼ˆStatement stmt, String sqlï¼‰;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¼•å…¥å›è°ƒåŸå› ï¼š</strong></p>
<p>JdbcTemplateæ˜¯æŠ½è±¡ç±»ï¼Œä¸èƒ½å¤Ÿç‹¬ç«‹ä½¿ç”¨ï¼Œæˆ‘ä»¬æ¯æ¬¡è¿›è¡Œæ•°æ®è®¿é—®çš„æ—¶å€™éƒ½è¦ç»™å‡ºä¸€ä¸ªç›¸åº”çš„å­ç±»å®ç°,è¿™æ ·è‚¯å®šä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥å°±å¼•å…¥äº†å›è°ƒã€‚</p>
<p>å›è°ƒä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StatementCallback</span></span>&#123;</span><br><span class="line">    Object doWithStatementï¼ˆStatement stmtï¼‰;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨å›è°ƒæ–¹æ³•é‡å†™JdbcTemplateæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcTemplate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> Object executeï¼ˆStatementCallback callbackï¼‰&#123;</span><br><span class="line">        Connection con=<span class="keyword">null</span>;</span><br><span class="line">        Statement stmt=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con=getConnectionï¼ˆï¼‰;</span><br><span class="line">            stmt=con.createStatementï¼ˆï¼‰;</span><br><span class="line">            Object retValue=callback.doWithStatementï¼ˆstmtï¼‰;</span><br><span class="line">            <span class="keyword">return</span> retValue;</span><br><span class="line">        &#125;<span class="keyword">catch</span>ï¼ˆSQLException eï¼‰&#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            closeStatementï¼ˆstmtï¼‰;</span><br><span class="line">            releaseConnectionï¼ˆconï¼‰;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...<span class="comment">//å…¶å®ƒæ–¹æ³•å®šä¹‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Jdbcä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">JdbcTemplate jdbcTemplate=...;</span><br><span class="line">    <span class="keyword">final</span> String sql=...;</span><br><span class="line">    StatementCallback callback=<span class="keyword">new</span> StatementCallback()&#123;</span><br><span class="line">    <span class="keyword">public</span> Object=doWithStatement(Statement stmt)&#123;</span><br><span class="line">        <span class="keyword">return</span> ...;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">jdbcTemplate.execute(callback);</span><br></pre></td></tr></table></figure>

<p><strong>ä¸ºä»€ä¹ˆJdbcTemplateæ²¡æœ‰ä½¿ç”¨ç»§æ‰¿ï¼Ÿ</strong></p>
<p>å› ä¸ºè¿™ä¸ªç±»çš„æ–¹æ³•å¤ªå¤šï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯æƒ³ç”¨åˆ°JdbcTemplateå·²æœ‰çš„ç¨³å®šçš„ã€å…¬ç”¨çš„æ•°æ®åº“è¿æ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠå˜åŒ–çš„ä¸œè¥¿æŠ½å‡ºæ¥ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ å…¥JdbcTemplateçš„æ–¹æ³•ä¸­ã€‚ä½†æ˜¯å˜åŒ–çš„ä¸œè¥¿æ˜¯ä¸€æ®µä»£ç ï¼Œè€Œä¸”è¿™æ®µä»£ç ä¼šç”¨åˆ°JdbcTemplateä¸­çš„å˜é‡ã€‚æ€ä¹ˆåŠï¼Ÿ</p>
<p>é‚£æˆ‘ä»¬å°±ç”¨å›è°ƒå¯¹è±¡å§ã€‚åœ¨è¿™ä¸ªå›è°ƒå¯¹è±¡ä¸­å®šä¹‰ä¸€ä¸ªæ“çºµJdbcTemplateä¸­å˜é‡çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å»å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œå°±æŠŠå˜åŒ–çš„ä¸œè¥¿é›†ä¸­åˆ°è¿™é‡Œäº†ã€‚ç„¶åæˆ‘ä»¬å†ä¼ å…¥è¿™ä¸ªå›è°ƒå¯¹è±¡åˆ°JdbcTemplateï¼Œä»è€Œå®Œæˆäº†è°ƒç”¨ã€‚</p>
<p>ä½œè€…ï¼šicoding91</p>
<p>é“¾æ¥ï¼šblog.csdn.net/caoxiaohong1005</p>

            </div>
            
                <div class="prev-or-next">
                    <div class="post-foot-prev">
                        
                    </div>
                   
                    <div class="post-foot-prev">
                        
                            <a href="/f943ea312617/" target="_self">
                                <span>NEXT: Mavenæ‰“åŒ…çš„å‚æ•°å­¦ä¹ </span>
                                <i class="iconfont icon-chevronright"></i>
                            </a>
                        
                    </div>
                </div>
            
        </div>
        
  <div class="post-catalog" id="catalog">
    <div class="title">ç›®å½•</div>
    <div class="catalog-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82-%E9%9D%9E23%E7%A7%8D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E4%B8%80%E7%A7%8D"><span class="toc-text">1. ç®€å•å·¥å‚(é23ç§è®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%84%8F%E4%B9%89%EF%BC%9A"><span class="toc-text">è®¾è®¡æ„ä¹‰ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95"><span class="toc-text">2.å·¥å‚æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="toc-text">3.å•ä¾‹æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="toc-text">4. é€‚é…å™¨æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="toc-text">5.è£…é¥°å™¨æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="toc-text">6. ä»£ç†æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-text">7. è§‚å¯Ÿè€…æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F"><span class="toc-text">8.ç­–ç•¥æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%A8%A1%E7%89%88%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F"><span class="toc-text">9.æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</span></a></li></ol>
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




        <!--
    
	-->
        
            <div class="comments-container">
                
  <div id="giteement-ctn"></div>
  
    <!-- <link rel="stylesheet" href="https://giteement.oss-cn-beijing.aliyuncs.com/wd-discuss.css"> -->
    <!-- <script src="https://giteement.oss-cn-beijing.aliyuncs.com/discuss_hexo.js"></script> -->
    <link rel="stylesheet" href="https://giteement.oss-cn-beijing.aliyuncs.com/default.css">
    <script src="https://giteement.oss-cn-beijing.aliyuncs.com/giteement.browser.js"></script>
  
  <script>
  var giteement = new Giteement({
    id: '20210315140226',
    owner: 'haydnch',
    repo: 'haydnch',
    backcall_uri: 'https://haydnch.gitee.io/',
    oauth_uri: 'https://cors-anywhere.herokuapp.com/https://gitee.com/oauth/token',
    oauth: {
      client_id: 'd926679348e52f04cd3ed750aeb5c551e2160731e8824fc9575edfe29928f837',
      client_secret: '67d0c535f28f2fadd81c2cfdde6019c7a0320fac174290b42e9209a94a256860'
    },
  })
  giteement.render('giteement-ctn')
  </script>

            </div>
        
    </div>


        <div class="footer">
  <div class="social">
    <ul>
      
        <li>
          <a title="github" href="https://github.com/haydnch/haydnch.github.io">
            <i class="iconfont icon-github"></i>
          </a>
        </li>
      
        <li>
          <a title="twitter" href="">
            <i class="iconfont icon-twitter"></i>
          </a>
        </li>
      
        <li>
          <a title="å¾®ä¿¡" href="/about/">
            <i class="iconfont icon-wechat"></i>
          </a>
        </li>
      
        <li>
          <a title="å¾®åš" href="https://weibo.com/574422066/">
            <i class="iconfont icon-weibo"></i>
          </a>
        </li>
      
    </ul>
  </div>
  
  
    <div class="footer-more">
      <a href="https://github.com/zchengsite/hexo-theme-oranges">Copyright Â© Oranges 2020 | Powered by Hexo</a>
    </div>
  
 
 
	 <div class="visit">
        <!-- ä¸è’œå­ç»Ÿè®¡ -->
		<span id="busuanzi_container_site_uv">
                ğŸ’šå…±æœ‰<span id="busuanzi_value_site_uv"></span>ä½è®¿å®¢
        </span>
        <span id="busuanzi_container_site_pv">
                è®¿é—®äº†<span id="busuanzi_value_site_pv"></span>æ¬¡ğŸ’™
        
        
	</div>
     
	 
  
</div>

      </div>

      <div class="back-to-top hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



      
  <div class="search-icon" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        <input type="text" class="search-input" id="search-input" placeholder="æœç´¢æ–‡ç« å…³é”®å­—...">
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
	var searchOverlayArea = document.querySelector(".search-overlay")
	
    inputArea.onclick = function(){ 
	  getSearchFile(); 
	  this.onclick = null 
	}		    

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }
  
    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }
  
    function blurSearchContent(e) {
	  if (e.target === searchOverlayArea) {
    	      
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)
  </script>
  
  
<script src="/js/search.js"></script>




    </div>
	
  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":200,"height":350,"hOffset":40,"vOffset":-65},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"dialog":{"enable":true,"hitokoto":true},"log":false});</script></body>
</html>
